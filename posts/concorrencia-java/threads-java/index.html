<!doctype html><html lang=pt dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput | Kaue Gatto</title><meta name=keywords content="Concorrencia,JAVA"><meta name=description content="Vamos explorar como fazer testes em java!"><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=apple-touch-icon href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=mask-icon href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=pt href=https://kaue.cat/posts/concorrencia-java/threads-java/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6MZTJBEG75"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6MZTJBEG75",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-6MZTJBEG75","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6MZTJBEG75"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6MZTJBEG75",{anonymize_ip:!1})}</script><meta property="og:title" content="1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput"><meta property="og:description" content="Vamos explorar como fazer testes em java!"><meta property="og:type" content="article"><meta property="og:url" content="https://kaue.cat/posts/concorrencia-java/threads-java/"><meta property="og:image" content="https://kaue.cat/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-29T19:00:03+00:00"><meta property="article:modified_time" content="2024-03-29T19:00:03+00:00"><meta property="og:site_name" content="Kaue Gatto - Blog de Desenvolvimento"><meta property="og:see_also" content="https://kaue.cat/posts/concorrencia-java/desafios/"><meta property="og:see_also" content="https://kaue.cat/posts/concorrencia-java/thread-safe/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kaue.cat/%3Cimage%20path/url%3E"><meta name=twitter:title content="1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput"><meta name=twitter:description content="Vamos explorar como fazer testes em java!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kaue.cat/posts/"},{"@type":"ListItem","position":3,"name":"1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput","item":"https://kaue.cat/posts/concorrencia-java/threads-java/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput","name":"1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput","description":"Vamos explorar como fazer testes em java!","keywords":["Concorrencia","JAVA"],"articleBody":"Seja bem vindo, esse daqui √© o primeiro de 6 posts sobre concorr√™ncia em Java. Nosso roteiro √©:\n1. Threads! Processando em Paralelo e Ganhando Throughput 2. Sincroniza√ß√£o de Threads - DeadLocks, Zonas Cr√≠ticas e Condi√ß√µes de Corrida 3. Concorr√™ncia, agora melhor - Classes Thread Safe 4. Executors E Thread Pools 5. CompletableFuture 6. Virtual Threads\nContexto Threads s√£o unidades de execu√ß√£o dentro de um processo. Um processo √© um programa em execu√ß√£o que cont√©m pelo menos uma thread. As threads permitem que um programa execute v√°rias tarefas ao mesmo tempo, alocando uma thread em cada processador dispon√≠vel.\nVantagens de programar com m√∫ltiplas threads: Uma das principais raz√µes para usar m√∫ltiplas threads √© melhorar o desempenho de um programa. Tarefas pesadas e demoradas podem ser divididas em threads separadas, permitindo que diferentes partes do programa sejam executadas em paralelo. Isso pode levar a uma utiliza√ß√£o mais eficiente dos recursos da CPU e, consequentemente, a um tempo de resposta mais r√°pido.\nNo entanto, programar com threads tamb√©m traz desafios, como a necessidade de lidar com concorr√™ncia (quando v√°rias threads tentam acessar ou modificar os mesmos recursos ao mesmo tempo) e a possibilidade de erros dif√≠ceis de depurar (como as condi√ß√µes de corrida), pois os resultados de um mesmo c√≥digo n√£o ser√£o necessariamente os mesmos (n√£o determin√≠sticos).\nO multithreading ajuda ou n√£o? 1. Opera√ß√µes de I/O: Quando um programa precisa realizar opera√ß√µes de entrada/sa√≠da ‚Äì I/O (e elas s√£o o gargalo), como leitura/grava√ß√£o de arquivos, comunica√ß√£o com bancos de dados ou solicita√ß√µes de rede, h√° frequentemente momentos em que a CPU fica ociosa, esperando que os dados sejam lidos ou escritos. Nessa situa√ß√£o, se uma nova thread tomasse conta da situa√ß√£o, ela n√£o seria mais executada pelo processador enquanto estivesse ociosa, pois aconteceria o que chamamos de troca de contexto, que √© basicamente fazer com que outra thread seja processada. Isso permite que outras threads que necessitem de processamento real tenham suas opera√ß√µes executadas pelos n√∫cleos da CPU, ou at√© mesmo lan√ßar (ou usar) mais threads para j√° lan√ßar outras chamadas que tamb√©m exigem esse tempo de espera, conhecidas como bloqueantes. Isso ajuda a aproveitar melhor o tempo da CPU, melhorando a efici√™ncia geral do programa. Imagine um contexto onde voc√™ precisa ler dois arquivos .txt, essa opera√ß√£o poderia ser realizada paralelamente se lan√ß√°ssemos duas threads, uma para ler cada arquivo, sendo cada uma processada em um n√∫cleo, diminuindo o tempo de execu√ß√£o essencialmente pela metade\n2. C√≥digo CPU-bound: Quando o programa est√° executando tarefas intensivas em CPU, como c√°lculos matem√°ticos complexos, simula√ß√µes ou processamento de imagem, uma √∫nica thread pode n√£o ser capaz de aproveitar totalmente a capacidade de processamento da CPU. Dividir essas tarefas em threads separadas permite que m√∫ltiplos n√∫cleos da CPU trabalhem em paralelo, acelerando o processamento. Nesse caso, devemos tomar cuidado, pois a quantidade de tarefas que pode ser paralelizada realmente √© igual a quantidade de n√∫cleos do seu processador (l√≥gicos + f√≠sicos).\nA imagem acima representa a troca de contexto, note que esse processo n√£o √© necessariamente instant√¢neo e resulta em poss√≠vel perda de cache, o que pode ser agressor √† performance - Fonte.\nA frequ√™ncia de trocas de contexto tem impacto na efici√™ncia do sistema operacional: quanto menor o n√∫mero de trocas de contexto e menor a dura√ß√£o de cada troca, mais tempo sobrar√° para a execu√ß√£o das tarefas em si. Assim, √© poss√≠vel definir uma medida de efici√™ncia E do uso do processador, em fun√ß√£o das dura√ß√µes m√©dias do quantum de tempo t e da troca de contexto c.\nJava: Threads! O Objeto Thread O objeto java.lang.Thread √© um wrapper em cima das threads do sistema operacional\n[‚ùó] Importante Note que as Threads s√£o objetos wrappers em torno das threads do SO, portanto, se essas threads do S.O s√£o pesadas (e s√£o), as Threads em Java tamb√©m s√£o.\nEm Java, podemos trabalhar com threads de algumas maneiras, a primeira que veremos √© com a classe Thread, essas classes precisam dar o override do m√©todo run:\nclass ThreadExample extends Thread{ char c; public ThreadExample(char c) { this.c = c; } @Override public void run() { System.out.printf(\"\\nCome√ßouuu!: %s\\n\", c); for (int i = 0; i \u003c 100 ; i++) { System.out.print(c); } } } public static void main(String[] args) { /* Todo programa em execu√ß√£o √© \"feito\" de threads, esse n√£o √© uma exce√ß√£o*/ Thread.currentThread().getName(); ThreadExample t1 = new ThreadExample('A'); ThreadExample t2 = new ThreadExample('B'); ThreadExample t3 = new ThreadExample('C'); t1.run(); t2.run(); t3.run(); } Pronto! (S√≥ que n√£o) ‚Üí Note que os objetos thread ainda est√£o rodando na mesma thread, nesse caso, usar Thread.run() executa o m√©todo run, nao inicia a thread, nesse caso, devemos rodar start()!\npublic class Thread01 { public static void main(String[] args) { /* Todo programa em execu√ß√£o √© \"feito\" de threads, esse n√£o √© uma exce√ß√£o*/ Thread.currentThread().getName(); ThreadExample t1 = new ThreadExample('A'); ThreadExample t2 = new ThreadExample('B'); ThreadExample t3 = new ThreadExample('C'); t1.start(); t2.start(); t3.start(); } } [‚ùì] Reflex√£o Criar um objeto do tipo thread faz sentido? Voc√™ est√° especializando uma thread realmente? A heran√ßa faz sentido nesse caso? [[2. SOLID]]\n1. Interface Runnable Nesse caso, acho v√°lido come√ßar diferente, vamos ler uma parte da javadoc da classe runnable\n0. Javadoc The Runnable interface should be implemented by any class whose instances are intended to be executed by a thread. The class must define a method of no arguments called run.\nIn addition, Runnable provides the means for a class to be active while not subclassing Thread. A class that implements Runnable can run without subclassing Thread by instantiating a Thread instance and passing itself in as the target. In most cases, the Runnable interface should be used if you are only planning to override the run() method and no other Thread methods. This is important because classes should not be subclassed unless the programmer intends on modifying or enhancing the fundamental behavior of the class.\nA documenta√ß√£o do JAVA responde perfeitamente a reflex√£o anterior, se voc√™ discorda, pode seguir em frente, mas particularmente acho que √© um argumento dif√≠cil de rebater.\nExemplo:\nclass ThreadRunnable implements Runnable { char c; public ThreadRunnable(char c) { this.c = c; } @Override public void run() { System.out.printf(\"\\nCome√ßouuu!: %s\\n\", c); for (int i = 0; i \u003c 100; i++) { System.out.print(c); } } } public class Thread01 { public static void main(String[] args) { /* Todo programa em execu√ß√£o √© \"feito\" de threads, esse n√£o √© uma exce√ß√£o*/ Thread.currentThread().getName(); var t1Runnable = new ThreadRunnable('a'); var t2Runnable = new ThreadRunnable('b'); var t3Runnable = new ThreadRunnable('c'); Thread t1 = new Thread(t1Runnable); Thread t2 = new Thread(t2Runnable); Thread t3 = new Thread(t3Runnable); t1.start(); t2.start(); t3.start(); } } Estados de uma thread √â interessante sabermos disso, pois podemos dar dicas para o S.O como dizer para que uma thread running pare, ou notificando que uma thread se tornou Runnable.\nMelhorando o C√≥digo Se n√£o precisarmos de construtor! podemos usar uma lambda, pois Runnable √© uma @FunctionalInterface:\nThread t1 = new Thread( () -\u003e {/*codigo*/}); Ou, um pouco mais verboso:\nRunnable simplerRunnable = () -\u003e { System.out.printf(\"\\nCome√ßouuu!: %s\\n\", c); for (int i = 0; i \u003c 100; i++) { System.out.print(c); } }; Prioridade Prioridades podem ser atribu√≠das √† threads, conforme mostra o c√≥digo:\nThread t3 = new Thread(t3Runnable,\"nomeC\"); t3.setPriority(Thread.MAX_PRIORITY); [‚ùó] Importante Note que prioridades s√£o indica√ß√µes do que voc√™ deseja para o scheduler, uma thread de prioridade 1 pode rodar andar da prioridade 10, voc√™ n√£o deve desenvolver um c√≥digo baseado em prioridade\nSleep Imagine que voc√™ deseja que uma thread ocorra sem fim, mas rode a cada 2 minutos, como pode fazer isso? ü§î\nUma das maneiras √© usar um Thread.sleep(milis) e pedir para que a thread pare por algum tempo, note que √© importante esse c√≥digo estar dentro de um try-catch, por sua possibilidade de gerar uma exce√ß√£o (caso a thread seja interrompida, por exemplo)\n@Override public void run() { System.out.printf(\"\\nCome√ßouuu!: %s\\n\", c); for (int i = 0; i \u003c 100; i++) { System.out.print(c); } try { Thread.sleep(1000); } catch (InterruptedException e) { throw new RuntimeException(e); } } Yield Yield serve para indicarmos / darmos uma dica para o scheduler do JVM fa√ßa a thread voltar para Runnable (pare) por um tempo. [[2. Come√ßando com o C√≥digo]]\nO yield √© um dos principais elementos que permitem a exist√™ncia de Virtual Threads.\nJoin Join serve para avisarmos a thread main que ela deve esperar para continuar seu fluxo q uando as opera√ß√µes terminarem Quando voc√™ chama o m√©todo join em uma determinada (thread), voc√™ est√° essencialmente dizendo: ‚ÄúPera ai, s√≥ continua quando essa tarefa terminar‚Äù. Isso √© √∫til quando voc√™ tem partes do programa que precisam estar totalmente prontas antes que outras partes possam prosseguir. Um exemplo seria um cen√°rio onde voc√™ precisa comparar 3 pesquisas de viagem de avi√£o para conseguir ver o pre√ßo mais barato, voc√™ pode dar o join nas 3 threads que rodaram essa opera√ß√£o de I/O (a ordem n√£o ir√° importar, pois estaremos limitados pela √∫ltima de qualquer jeito) e ent√£o depois comparamos os resultados\nResumidamnete, o join √© especialmente √∫til quando voc√™ precisa garantir a ordem correta das opera√ß√µes ou quando precisa coletar resultados de v√°rias threads antes de prosseguir.\n// t1 roda antes de t1 e t2 Thread t1 = new Thread(new ThreadRunnableYieldJoin('A')); Thread t2 = new Thread(new ThreadRunnableYieldJoin('B')); Thread t3 = new Thread(new ThreadRunnableYieldJoin('C')); t1.start(); try { t1.join(); } catch (InterruptedException e) { throw new RuntimeException(e); } var threads = List.of(t2,t3); threads.forEach(Thread::start); public static void main(String[] args) { // t1 e t2 em paralelo Thread t1 = new Thread(new ThreadRunnableYieldJoin('A')); Thread t2 = new Thread(new ThreadRunnableYieldJoin('B')); Thread t3 = new Thread(new ThreadRunnableYieldJoin('C')); t1.start(); t2.start(); try { t1.join(); t2.join(); } catch (InterruptedException e) { throw new RuntimeException(e); } t3.start(); } } Refer√™ncias [üìö] Qual a finalidade do Transient e Volatile no Java? As vezes quando vou declarar meus atributos noto o transient e o volatile. https://pt.stackoverflow.com/a/116080\n[üìö] Maratona Java Virado no Jiraya Melhor, maior, e o mais completo curso de Java em portugu√™s gr√°tis de toda Internet est√° de volta. https://www.youtube.com/playlist?list=PL62G310vn6nFIsOCC0H-C2infYgwm8SWW\u003e)\n","wordCount":"1659","inLanguage":"pt","image":"https://kaue.cat/%3Cimage%20path/url%3E","datePublished":"2024-03-29T19:00:03Z","dateModified":"2024-03-29T19:00:03Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kaue.cat/posts/concorrencia-java/threads-java/"},"publisher":{"@type":"Organization","name":"Kaue Gatto","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kaue.cat accesskey=h title="Home (Alt + H)"><img src=https://kaue.cat/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://kaue.cat/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://kaue.cat/archives title=Arquivo><span>Arquivo</span></a></li><li><a href=https://kaue.cat/search/ title=Buscar><span>Buscar</span></a></li><li><a href=https://kaue.cat/series/ title=S√©ries><span>S√©ries</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://kaue.cat>In√≠cio</a>&nbsp;¬ª&nbsp;<a href=https://kaue.cat/posts/>Posts</a></div><h1 class=post-title>1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput</h1><div class=post-description>Vamos explorar como fazer testes em java!</div><div class=post-meta><span title='2024-03-29 19:00:03 +0000 UTC'>mar√ßo 29, 2024</span>&nbsp;¬∑&nbsp;8 minutos&nbsp;¬∑&nbsp;1659 palavras&nbsp;¬∑&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/kauegatto/kauedotcat/content/posts/concorrencia-java/threads-java.md rel="noopener noreferrer" target=_blank>Sugerir Altera√ß√µes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Conte√∫do</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#o-objeto-thread>O Objeto Thread</a></li><li><a href=#1-interface-runnable>1. Interface Runnable</a></li><li><a href=#0-javadoc>0. Javadoc</a></li></ul><ul><li><a href=#prioridade>Prioridade</a></li><li><a href=#sleep>Sleep</a></li><li><a href=#yield>Yield</a></li><li><a href=#join>Join</a></li></ul></nav></div></details></div><div class=post-content><p>Seja bem vindo, esse daqui √© o primeiro de 6 posts sobre concorr√™ncia em Java. Nosso roteiro √©:</p><p><strong>1. Threads! Processando em Paralelo e Ganhando Throughput</strong>
2. Sincroniza√ß√£o de Threads - DeadLocks, Zonas Cr√≠ticas e Condi√ß√µes de Corrida
3. Concorr√™ncia, agora melhor - Classes Thread Safe
4. Executors E Thread Pools
5. CompletableFuture
6. Virtual Threads</p><h1 id=contexto>Contexto<a hidden class=anchor aria-hidden=true href=#contexto>#</a></h1><p>Threads s√£o unidades de execu√ß√£o dentro de um processo. Um processo √© um programa em execu√ß√£o que cont√©m pelo menos uma thread. As threads permitem que um programa execute v√°rias tarefas ao mesmo tempo, alocando uma thread em cada processador dispon√≠vel.</p><h1 id=vantagens-de-programar-com-m√∫ltiplas-threads><strong>Vantagens de programar com m√∫ltiplas threads:</strong><a hidden class=anchor aria-hidden=true href=#vantagens-de-programar-com-m√∫ltiplas-threads>#</a></h1><p>Uma das principais raz√µes para usar m√∫ltiplas threads √© melhorar o desempenho de um programa. Tarefas pesadas e demoradas podem ser divididas em threads separadas, permitindo que diferentes partes do programa sejam executadas em paralelo. Isso pode levar a uma utiliza√ß√£o mais eficiente dos recursos da CPU e, consequentemente, a um tempo de resposta mais r√°pido.</p><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/penw7eg1a1bfdvjuuew8.png alt="Image description"></p><p>No entanto, programar com threads tamb√©m traz desafios, como a necessidade de lidar com concorr√™ncia (quando v√°rias threads tentam acessar ou modificar os mesmos recursos ao mesmo tempo) e a possibilidade de erros dif√≠ceis de depurar (como as condi√ß√µes de corrida), pois os resultados de um mesmo c√≥digo n√£o ser√£o necessariamente os mesmos (n√£o determin√≠sticos).</p><h1 id=o-multithreading-ajuda-ou-n√£o>O multithreading ajuda ou n√£o?<a hidden class=anchor aria-hidden=true href=#o-multithreading-ajuda-ou-n√£o>#</a></h1><p><strong>1. Opera√ß√µes de I/O:</strong>
Quando um programa precisa realizar opera√ß√µes de entrada/sa√≠da &ndash; I/O (e elas s√£o o gargalo), como leitura/grava√ß√£o de arquivos, comunica√ß√£o com bancos de dados ou solicita√ß√µes de rede, h√° frequentemente momentos em que a CPU fica ociosa, esperando que os dados sejam lidos ou escritos.
Nessa situa√ß√£o, se uma nova thread tomasse conta da situa√ß√£o, ela n√£o seria mais executada pelo processador enquanto estivesse ociosa, pois aconteceria o que chamamos de troca de contexto, que √© basicamente fazer com que outra thread seja processada. Isso permite que outras threads que necessitem de processamento real tenham suas opera√ß√µes executadas pelos n√∫cleos da CPU, ou at√© mesmo lan√ßar (ou usar) mais threads para j√° lan√ßar outras chamadas que tamb√©m exigem esse tempo de espera, conhecidas como bloqueantes. Isso ajuda a aproveitar melhor o tempo da CPU, <strong>melhorando a efici√™ncia geral do programa.</strong>
Imagine um contexto onde voc√™ precisa ler dois arquivos .txt, essa opera√ß√£o poderia ser realizada paralelamente se lan√ß√°ssemos duas threads, uma para ler cada arquivo, sendo cada uma processada em um n√∫cleo, diminuindo o tempo de execu√ß√£o essencialmente pela metade</p><p><strong>2. C√≥digo CPU-bound:</strong>
Quando o programa est√° executando tarefas intensivas em CPU, como c√°lculos matem√°ticos complexos, simula√ß√µes ou processamento de imagem, uma √∫nica thread pode n√£o ser capaz de aproveitar totalmente a capacidade de processamento da CPU. Dividir essas tarefas em threads separadas permite que m√∫ltiplos n√∫cleos da CPU trabalhem em paralelo, acelerando o processamento.
Nesse caso, devemos tomar cuidado, pois a quantidade de tarefas que pode ser paralelizada realmente √© igual a quantidade de n√∫cleos do seu processador (l√≥gicos + f√≠sicos).</p><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/bstgdyjfdfyg8rj92gjj.png alt="Image description"></p><p>A imagem acima representa a troca de contexto, note que esse processo n√£o √© necessariamente instant√¢neo e resulta em poss√≠vel perda de cache, o que pode ser agressor √† performance - <a href="https://wiki.inf.ufpr.br/maziero/lib/exe/fetch.php?media=socm:socm-05.pdf">Fonte</a>.</p><blockquote><p>A frequ√™ncia de trocas de contexto tem impacto na efici√™ncia do sistema operacional: quanto menor o n√∫mero de trocas de contexto e menor a dura√ß√£o de cada troca, mais tempo sobrar√° para a execu√ß√£o das tarefas em si. Assim, √© poss√≠vel definir uma medida de efici√™ncia E do uso do processador, em fun√ß√£o das dura√ß√µes m√©dias do quantum de tempo <em>t</em> e da troca de contexto <em>c</em>.</p></blockquote><h1 id=java-threads>Java: Threads!<a hidden class=anchor aria-hidden=true href=#java-threads>#</a></h1><h2 id=o-objeto-thread>O Objeto Thread<a hidden class=anchor aria-hidden=true href=#o-objeto-thread>#</a></h2><p>O objeto <code>java.lang.Thread</code> √© um <em>wrapper</em> em cima das threads do sistema operacional</p><blockquote><p>[‚ùó] <strong>Importante</strong>
Note que as Threads s√£o objetos wrappers em torno das threads do SO, portanto, se essas threads do S.O s√£o pesadas (e s√£o), as Threads em Java tamb√©m s√£o.</p></blockquote><p>Em Java, podemos trabalhar com threads de algumas maneiras, a primeira que veremos √© com a classe Thread, essas classes precisam dar o override do m√©todo <code>run</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>ThreadExample</span> <span class=kd>extends</span> <span class=n>Thread</span><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>c</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=nf>ThreadExample</span><span class=o>(</span><span class=kt>char</span> <span class=n>c</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>c</span> <span class=o>=</span> <span class=n>c</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;\nCome√ßouuu!: %s\n&#34;</span><span class=o>,</span> <span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span> <span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* Todo programa em execu√ß√£o √© &#34;feito&#34; de threads, esse n√£o √© uma exce√ß√£o*/</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>ThreadExample</span> <span class=n>t1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadExample</span><span class=o>(</span><span class=sc>&#39;A&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ThreadExample</span> <span class=n>t2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadExample</span><span class=o>(</span><span class=sc>&#39;B&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ThreadExample</span> <span class=n>t3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadExample</span><span class=o>(</span><span class=sc>&#39;C&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>t1</span><span class=o>.</span><span class=na>run</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>t2</span><span class=o>.</span><span class=na>run</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>t3</span><span class=o>.</span><span class=na>run</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span></code></pre></div><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/9ed6s7jk91lxnzgyrl4p.png alt="Image description"></p><p>Pronto! (S√≥ que n√£o) ‚Üí Note que os objetos thread ainda est√£o rodando na mesma thread, nesse caso, usar <code>Thread.run()</code> executa o m√©todo run, nao inicia a thread, nesse caso, devemos rodar <code>start()</code>!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Thread01</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* Todo programa em execu√ß√£o √© &#34;feito&#34; de threads, esse n√£o √© uma exce√ß√£o*/</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>ThreadExample</span> <span class=n>t1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadExample</span><span class=o>(</span><span class=sc>&#39;A&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ThreadExample</span> <span class=n>t2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadExample</span><span class=o>(</span><span class=sc>&#39;B&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ThreadExample</span> <span class=n>t3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadExample</span><span class=o>(</span><span class=sc>&#39;C&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>t1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>t2</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>t3</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ys8g283085yvfm7jr8am.png alt="Image description"></p><blockquote><p>[‚ùì] <strong>Reflex√£o</strong>
Criar um objeto do tipo thread faz sentido? Voc√™ est√° especializando uma thread realmente? A heran√ßa faz sentido nesse caso? [[2. SOLID]]</p></blockquote><h2 id=1-interface-runnable>1. Interface Runnable<a hidden class=anchor aria-hidden=true href=#1-interface-runnable>#</a></h2><p>Nesse caso, acho v√°lido come√ßar diferente, vamos ler uma parte da javadoc da classe runnable</p><h2 id=0-javadoc>0. Javadoc<a hidden class=anchor aria-hidden=true href=#0-javadoc>#</a></h2><blockquote><p>The Runnable interface should be implemented by any class whose instances are intended to be executed by a thread. The class must define a method of no arguments called run.</p><p>In addition, Runnable provides the means for a class to be active while not subclassing Thread. A class that implements <code>Runnable</code> can run without subclassing Thread by instantiating a Thread instance and passing itself in as the target.
<strong>In most cases, the Runnable interface should be used if you are only planning to override the run() method and no other Thread methods. This is important because classes should not be subclassed unless the programmer intends on modifying or enhancing the fundamental behavior of the class.</strong></p></blockquote><p>A documenta√ß√£o do JAVA responde perfeitamente a reflex√£o anterior, se voc√™ discorda, pode seguir em frente, mas <em>particularmente</em> acho que √© um argumento dif√≠cil de rebater.</p><p>Exemplo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>ThreadRunnable</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>c</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=nf>ThreadRunnable</span><span class=o>(</span><span class=kt>char</span> <span class=n>c</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>c</span> <span class=o>=</span> <span class=n>c</span><span class=o>;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;\nCome√ßouuu!: %s\n&#34;</span><span class=o>,</span> <span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Thread01</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* Todo programa em execu√ß√£o √© &#34;feito&#34; de threads, esse n√£o √© uma exce√ß√£o*/</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>var</span> <span class=n>t1Runnable</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadRunnable</span><span class=o>(</span><span class=sc>&#39;a&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>var</span> <span class=n>t2Runnable</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadRunnable</span><span class=o>(</span><span class=sc>&#39;b&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>var</span> <span class=n>t3Runnable</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ThreadRunnable</span><span class=o>(</span><span class=sc>&#39;c&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span> <span class=n>t1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>t1Runnable</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span> <span class=n>t2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>t2Runnable</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span> <span class=n>t3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>t3Runnable</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>t1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>t2</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>t3</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/xtufpjsnxr59ynqmzoky.png alt="Image description"></p><h1 id=estados-de-uma-thread>Estados de uma thread<a hidden class=anchor aria-hidden=true href=#estados-de-uma-thread>#</a></h1><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/jh06kptf646zydrr2cge.png alt="Image description"></p><p>√â interessante sabermos disso, pois podemos dar dicas para o S.O como dizer para que uma thread running pare, ou notificando que uma thread se tornou <em>Runnable</em>.</p><h1 id=melhorando-o-c√≥digo>Melhorando o C√≥digo<a hidden class=anchor aria-hidden=true href=#melhorando-o-c√≥digo>#</a></h1><p>Se n√£o precisarmos de construtor! podemos usar uma lambda, pois Runnable √© uma <code>@FunctionalInterface</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>Thread</span> <span class=n>t1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span> <span class=o>()</span> <span class=o>-&gt;</span> <span class=o>{</span><span class=cm>/*codigo*/</span><span class=o>});</span>
</span></span></code></pre></div><p>Ou, um pouco mais verboso:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Runnable</span> <span class=n>simplerRunnable</span> <span class=o>=</span> <span class=o>()</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;\nCome√ßouuu!: %s\n&#34;</span><span class=o>,</span> <span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>};</span>
</span></span></code></pre></div><h2 id=prioridade>Prioridade<a hidden class=anchor aria-hidden=true href=#prioridade>#</a></h2><p>Prioridades podem ser atribu√≠das √† threads, conforme mostra o c√≥digo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>Thread</span> <span class=n>t3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>t3Runnable</span><span class=o>,</span><span class=s>&#34;nomeC&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>t3</span><span class=o>.</span><span class=na>setPriority</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>MAX_PRIORITY</span><span class=o>);</span>
</span></span></code></pre></div><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/zt3ej75r8mh5riv86y5z.png alt="Image description"></p><blockquote><p>[‚ùó] <strong>Importante</strong>
Note que prioridades s√£o indica√ß√µes do que voc√™ deseja para o scheduler, uma thread de prioridade 1 pode rodar andar da prioridade 10, voc√™ n√£o deve desenvolver um c√≥digo baseado em prioridade</p></blockquote><h2 id=sleep>Sleep<a hidden class=anchor aria-hidden=true href=#sleep>#</a></h2><p>Imagine que voc√™ deseja que uma thread ocorra sem fim, mas rode a cada 2 minutos, como pode fazer isso? ü§î</p><p>Uma das maneiras √© usar um <code>Thread.sleep(milis)</code> e pedir para que a thread pare por algum tempo, note que √© importante esse c√≥digo estar dentro de um try-catch, por sua possibilidade de gerar uma exce√ß√£o (caso a thread seja interrompida, por exemplo)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=nd>@Override</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;\nCome√ßouuu!: %s\n&#34;</span><span class=o>,</span> <span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=n>c</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=mi>1000</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span></code></pre></div><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/wv4gzoo2utb9e5boydkr.png alt="Image description"></p><h2 id=yield>Yield<a hidden class=anchor aria-hidden=true href=#yield>#</a></h2><p>Yield serve para indicarmos / darmos uma <strong>dica</strong> para o scheduler do JVM fa√ßa a thread voltar para Runnable (pare) por um tempo. [[2. Come√ßando com o C√≥digo]]</p><p>O <em>yield</em> √© um dos principais elementos que permitem a exist√™ncia de <em>Virtual Threads</em>.</p><h2 id=join>Join<a hidden class=anchor aria-hidden=true href=#join>#</a></h2><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/9i0k24gf578muvwe4mud.png alt="Image description"></p><p>Join serve para avisarmos a thread main que ela deve <strong>esperar</strong> para continuar seu fluxo q uando as opera√ß√µes terminarem
Quando voc√™ chama o m√©todo <code>join</code> em uma determinada (thread), voc√™ est√° essencialmente dizendo: &ldquo;Pera ai, s√≥ continua quando essa tarefa terminar&rdquo;. Isso √© √∫til quando voc√™ tem partes do programa que precisam estar totalmente prontas antes que outras partes possam prosseguir.
Um exemplo seria um cen√°rio onde voc√™ precisa comparar 3 pesquisas de viagem de avi√£o para conseguir ver o pre√ßo mais barato, voc√™ pode dar o <code>join</code> nas 3 threads que rodaram essa opera√ß√£o de I/O (a ordem n√£o ir√° importar, pois estaremos limitados pela √∫ltima de qualquer jeito) e ent√£o depois comparamos os resultados</p><p>Resumidamnete, o <code>join</code> √© especialmente √∫til quando voc√™ precisa garantir a ordem correta das opera√ß√µes ou quando precisa coletar resultados de v√°rias threads antes de prosseguir.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=c1>// t1 roda antes de t1 e t2
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Thread</span> <span class=n>t1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>ThreadRunnableYieldJoin</span><span class=o>(</span><span class=sc>&#39;A&#39;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span> <span class=n>t2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>ThreadRunnableYieldJoin</span><span class=o>(</span><span class=sc>&#39;B&#39;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span> <span class=n>t3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>ThreadRunnableYieldJoin</span><span class=o>(</span><span class=sc>&#39;C&#39;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>t1</span><span class=o>.</span><span class=na>join</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>threads</span> <span class=o>=</span> <span class=n>List</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>t2</span><span class=o>,</span><span class=n>t3</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>threads</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>Thread</span><span class=o>::</span><span class=n>start</span><span class=o>);</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=c1>// t1 e t2 em paralelo
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Thread</span> <span class=n>t1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>ThreadRunnableYieldJoin</span><span class=o>(</span><span class=sc>&#39;A&#39;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span> <span class=n>t2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>ThreadRunnableYieldJoin</span><span class=o>(</span><span class=sc>&#39;B&#39;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>Thread</span> <span class=n>t3</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>ThreadRunnableYieldJoin</span><span class=o>(</span><span class=sc>&#39;C&#39;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>t1</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>t2</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>t1</span><span class=o>.</span><span class=na>join</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=n>t2</span><span class=o>.</span><span class=na>join</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>t3</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h1 id=refer√™ncias>Refer√™ncias<a hidden class=anchor aria-hidden=true href=#refer√™ncias>#</a></h1><blockquote><p>[üìö] <strong>Qual a finalidade do Transient e Volatile no Java?</strong>
<em>As vezes quando vou declarar meus atributos noto o transient e o volatile.</em>
<a href=https://pt.stackoverflow.com/a/116080>https://pt.stackoverflow.com/a/116080</a></p></blockquote><blockquote><p>[üìö] <strong>Maratona Java Virado no Jiraya</strong>
<em>Melhor, maior, e o mais completo curso de Java em portugu√™s gr√°tis de toda Internet est√° de volta.</em>
<a href="https://www.youtube.com/playlist?list=PL62G310vn6nFIsOCC0H-C2infYgwm8SWW">https://www.youtube.com/playlist?list=PL62G310vn6nFIsOCC0H-C2infYgwm8SWW</a>>)</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://kaue.cat/tags/concorrencia/>Concorrencia</a></li><li><a href=https://kaue.cat/tags/java/>JAVA</a></li></ul><nav class=paginav><a class=prev href=https://kaue.cat/posts/concorrencia-java/desafios/><span class=title>¬´ P√°gina Anterior</span><br><span>Sincroniza√ß√£o de Threads - DeadLocks, Zonas Cr√≠ticas e Condi√ß√µes de Corrida</span></a>
<a class=next href=https://kaue.cat/posts/virtual-threads/><span class=title>Pr√≥xima P√°gina ¬ª</span><br><span>[WIP] Virtual Threads em Java!</span></a></nav><div class=share-buttons><a>Compartilhar:</a><br><a target=_blank rel="noopener noreferrer" aria-label="share 1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput on x" href="https://x.com/intent/tweet/?text=1.%20Concorr%c3%aancia%20em%20Java%3a%20Threads%21%20Processando%20em%20Paralelo%20e%20Ganhando%20Throughput&url=https%3a%2f%2fkaue.cat%2fposts%2fconcorrencia-java%2fthreads-java%2f&hashtags=Concorrencia%2cJAVA"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fkaue.cat%2fposts%2fconcorrencia-java%2fthreads-java%2f&title=1.%20Concorr%c3%aancia%20em%20Java%3a%20Threads%21%20Processando%20em%20Paralelo%20e%20Ganhando%20Throughput&summary=1.%20Concorr%c3%aancia%20em%20Java%3a%20Threads%21%20Processando%20em%20Paralelo%20e%20Ganhando%20Throughput&source=https%3a%2f%2fkaue.cat%2fposts%2fconcorrencia-java%2fthreads-java%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 1. Concorr√™ncia em Java: Threads! Processando em Paralelo e Ganhando Throughput on whatsapp" href="https://api.whatsapp.com/send?text=1.%20Concorr%c3%aancia%20em%20Java%3a%20Threads%21%20Processando%20em%20Paralelo%20e%20Ganhando%20Throughput%20-%20https%3a%2f%2fkaue.cat%2fposts%2fconcorrencia-java%2fthreads-java%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></div></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//www-kaue-cat.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://kaue.cat>Kaue Gatto</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>