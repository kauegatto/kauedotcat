<!doctype html><html lang=pt dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SOLID! Um Post Aprofundado | Kaue Gatto</title><meta name=keywords content="SOLID,POO,ARCHITECTURE"><meta name=description content="Um post aprofundado sobre SOLID, com inúmeros exemplos de código e com um aprofundamento maior que o normal."><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="G-6MZTJBEG75"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=apple-touch-icon href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><link rel=mask-icon href=https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=pt href=https://kaue.cat/posts/solid/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6MZTJBEG75"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6MZTJBEG75",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-6MZTJBEG75","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6MZTJBEG75"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6MZTJBEG75",{anonymize_ip:!1})}</script><meta property="og:title" content="SOLID! Um Post Aprofundado"><meta property="og:description" content="Um post aprofundado sobre SOLID, com inúmeros exemplos de código e com um aprofundamento maior que o normal."><meta property="og:type" content="article"><meta property="og:url" content="https://kaue.cat/posts/solid/"><meta property="og:image" content="https://kaue.cat/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-12T16:30:03+00:00"><meta property="article:modified_time" content="2023-11-12T16:30:03+00:00"><meta property="og:site_name" content="Kaue Gatto - Blog de Desenvolvimento"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kaue.cat/%3Cimage%20path/url%3E"><meta name=twitter:title content="SOLID! Um Post Aprofundado"><meta name=twitter:description content="Um post aprofundado sobre SOLID, com inúmeros exemplos de código e com um aprofundamento maior que o normal."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kaue.cat/posts/"},{"@type":"ListItem","position":3,"name":"SOLID! Um Post Aprofundado","item":"https://kaue.cat/posts/solid/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SOLID! Um Post Aprofundado","name":"SOLID! Um Post Aprofundado","description":"Um post aprofundado sobre SOLID, com inúmeros exemplos de código e com um aprofundamento maior que o normal.","keywords":["SOLID","POO","ARCHITECTURE"],"articleBody":"Leitura no Notion: SOLID\nSei que existem 1 milhão de posts sobre SOLID, considero esse “guia” um pouco fora do comum pelo seu aprofundamento, tentei esclarecer todas as dúvidas que tinha ou poderia ter e sempre trazer exemplos, além de usar boas referências. Espero que esse post seja o seu guia definitivo de SOLID, assim como é para mim!\nO que é SOLID? SOLID é um Acrônimo para 5 boas práticas e/ou princípios que envolvem o desenvolvimento de um bom código orientado à objetos, não quero me estender na origem, vamos para os princípios!\nSingle Responsability Principle O nome, embora auto-explicativo e que muitas vezes levava esse princípio a ser explicado como “Uma classe deve ter uma, e apenas uma responsabilidade” não é necessariamente o que você deve pensar na hora de implementá-lo. Entenda esse padrão como : “Uma classe deve ter um, e apenas um motivo para mudar”. Ou seja, não crie uma classe com a função de Emitir Nota Fiscal, crie uma classe NotaFiscal, e garanta que apenas coisas que envolvem o domínio de Nota Fiscal irão altera-lá, a mudança da emissão não muda o seu domínio de Nota Fiscal. Se uma alteração na impressora fizer a classe Nota Fiscal ser alterada, algo está incorreto.\nA questão principal do SRP é o motivo para uma classe ser modificada. E esse motivo para mudança, em geral, está relacionado a um grupo de usuários ou stakeholders, que Uncle Bob chama de atores. - Desbravando Solid\nLevando em conta o que dizemos acima, também podemos dizer que o SRP pode ser definido por: “Um módulo deve ser responsável por um , e apenas um ator”. O ator que se importa com a função da emissão nota fiscal é o setor de vendas, o ator que se importa com suas horas extras, o rh, o ator que se importa com salvar no banco por id é a implementação de persistência.\nCada “interessado”, de negócio ou técnico, faz com que a classe tenha uma responsabilidade diferente.\nIdentificar classes que mudam por diversos motivos (ou atores) é simples, a coesão pode ser uma das métricas utilizadas:\nClasses coesas têm uma característica semelhante: os conceitos que essas classes representam estariam relacionados e separá-los seria pouco natural. O SRP, no fim das contas, é uma outra maneira de falar sobre a necessidade de código coeso. - Desbravando Solid\nAniche (OOP E SOLID para ninjas) sugere que, para encontrar classes pouco coesas, devemos procurar classes que:\nPossuem muitos métodos diferentes. São modificadas com frequência. Não param nunca de crescer. Outro fator importante é perceber a duplicação (ou pior, repetição) de código. Se seu código possui partes repetidas diversas vezes, tenha isso como um forte indicativo que essa responsabilidade provavelmente deveria estar encapsulada em algum lugar (e muito provavelmente em uma classe).\nPortanto, se seu sistema pega os dados, busca coisas no banco, salva como ePUB ou PDF, tudo em uma classe só, ele provavelmente não é coeso e muito menos segue o SRP. Um exemplo disso é que toda vez que a maneira que um pdf for gerado houver de mudar, você terá que mexer nessa classe principal, e se você tiver que repetir essa alteração em diversos pontos onde o código está repetido (o que já não é um bom indicador), você provavelmente terá problemas em algum momento (e mesmo que não tenha, sua manutenção definitivamente não está facilitada).\nCaso real Recentemente ajudei um amigo em um projeto pessoal, onde ele enviava emails para a confirmação de cadastro de usuários, todas essas responsabilidades ficavam dentro da mesma classe Usuário (Gerar token, enviar email, registrar usuário). A partir daí, trabalhamos para termos um código mais coeso, no momento em que um usuário é registrado, ele envia um evento de registro de usuário (o que é só um aviso falando: cadastrei um usuário). Com isso, uma classe chamada enviarEmailListener se prontificava a ouvir eventos de registro e alteração de senha de usuário e ela era a responsável por enviar emails. Portanto, com o refactor, a classe de Usuário não se preocupa com o que acontece após o registro do usuário, ela apenas notifica que isso aconteceu. Outro ponto de melhoria nisso foi a possibilidade de tornar o envio do email assíncrono, então para cadastrar um usuário, não precisavamos esperar o serviço de email fazer sua ação, ela é independente (nesse caso, não fazia sentido ser uma transação, o cadastro de um usuário não depende do email, se um erro ocorrer nessa etapa, ele pode só pedir outro email)\nNote que se tivermos mais ocasiões onde devemos enviar emails de usuário (além de cadastro e alteração de emails) podemos apenas adicionar um novo evento a ser ouvido pelo listener e se precisarmos mudar a forma de enviar email, mudamos apenas em um único método (o que aumenta MUITO a capacidade de manter o código), essa é a função do SRP.\nOpen-Closed Principle Software entities … should be open for extension, but closed for modification.\nA module will be said to be open if it is still available for extension. For example, it should be possible to add fields to the data structures it contains, or new elements to the set of functions it performs.\nEssas citações trazem uma noção base do que o OCP quer dizer, nosso código deve estar sempre pronto para evoluir. e de maneira natural, não devemos sentir a necessidade de modificar muitos arquivos diferentes, ou mesmo procurar (usando o CTRL+F, por exemplo) os lugares que devem ser alterados.\nA segunda parte diz sobre ser fechada para modificação. nesse aspecto, podemos entender que elas não devem ter seu comportamento alterado a todo momento.\nUm exemplo public class CalculadoraDePrecos { public double calcula(Compra produto) { Frete correios = new Frete(); double desconto = 0.0; // Inicialize desconto com um valor padrão if (REGRA 1) { // faz algo } if (REGRA 2) { // faz algo } return produto.getValor() * (1 - desconto) + frete; } } Note que sempre que adicionarmos regras de frete, nosso código precisará alterar a classe calculadora de preços, incluindo um novo IF, ou seja, a classe que implementar a regra de frete está acoplada à Calculadora de Preços\nUma segunda implementação comum é colocar os ifs dentro das classes específicas. Por exemplo, a classe Frete passaria a ter as diferentes regras de negócio (os mesmos if-else). Apesar de ficar melhor, continua claro que não é a melhor abordagem.\nMelhorando Se temos diferentes regras de desconto e de frete, basta criarmos interfaces que as representam:\npublic interface TabelaDePreco { double descontoPara(double valor); } public class TabelaDePreco1 implements TabelaDePreco { } public class TabelaDePreco2 implements TabelaDePreco { } public class TabelaDePreco3 implements TabelaDePreco { } public interface ServicoDeEntrega { double para(String cidade); } public class Frete1 implements ServicoDeEntrega {} public class Frete2 implements ServicoDeEntrega {} public class Frete3 implements ServicoDeEntrega {} “Veja que essa simples mudança altera toda a maneira de se lidar com a classe. Com ela ‘aberta’, ou seja, recebendo as dependências pelo construtor, podemos passar a implementação concreta que quisermos para ela. Se passarmos a implementação TabelaDePreco1, e invocarmos o método calcula(), o resultado será um; se passarmos a implementação TabelaDePreco2 e invocarmos o mesmo método, o resultado será outro.” (ANICHE, 2015).\npublic class CalculadoraDePrecos { private TabelaDePreco tabela; private ServicoDeEntrega entrega; public CalculadoraDePrecos(TabelaDePreco tabela, ServicoDeEntrega entrega) { this.tabela = tabela; this.entrega = entrega; } public double calcula(Compra produto) { double desconto = tabela.descontoPara(produto.getValor()); double frete = entrega.para(produto.getCidade()); return produto.getValor() * (1 - desconto) + frete; } } Note que aqui trabalhamos também com a inversão de dependências (DIP), o “D”, do SOLID.\n“Se o OCP declara\to objetivo de\tuma\tarquitetura OO, o DIP declara o seu mecanismo\tfundamental.”\nSe você ainda não leu sobre o DIP, continue lendo o post, mais tarde revisite esse ponto, vai fazer sentido 😃\nAbstrações e Capacidade de Extensão “O que discutimos aqui, de certa forma, mistura-se com a discussão do capítulo anterior sobre estabilidade e inversão de dependências. As interfaces (abstrações) TabelaDePreco e ServicoDeEntrega tendem a ser estáveis. A CalculadoraDePrecos é uma implementação mais instável e que só depende de abstrações estáveis. Pensar em abstrações nos ajuda a resolver o problema do acoplamento e, de quebra, ainda nos ajuda a ter códigos facilmente extensíveis. Isso é programar orientado a objetos. É lidar com acoplamento, coesão, pensando em abstrações para nossos problemas. Quando se tem uma boa abstração, é fácil evoluir o sistema. Seu sistema deve evoluir por meio de novas implementações dessas abstrações, previamente pensadas, e não por meio de diversos ifs espalhados por todo o código.” (ANICHE, 2015).\nDesign Pattern: Command Não vou me aprofundar em patterns nesse post, mas acho legal repassar alguns exemplos que vi no material base\npublic class EmissorNotaFiscal\t{ private\tRegrasDeTributacao\ttributacao; private\tLegislacaoFiscal\tlegislacao; private\tList\u003cAcaoPosEmissao\u003e\tacoes; //... public\tNotaFiscal\tgera(Fatura\tfatura) { List\u003cImposto\u003e\timpostos\t=\ttributacao.verifica(fatura); List\u003cIsencao\u003e\tisencoes\t=\tlegislacao.analisa(fatura); //\tmétodo\tauxiliar NotaFiscal\tnota\t=\taplica(impostos,\tisencoes); //\tmodificado for\t(AcaoPosEmissao\tacao:\tacoes)\t{ acao.faz(nota); } return\tnota; } Exemplo do livro Desbravando Solid (AQUILES, 2022)\nNote que é muito fácil adicionar novos comportamentos depois de uma nota fiscal ser emitida, podemos simplesmente adicionar um objeto na lista de ações, isso caracteriza o padrão Command.\nRecomendo a leitura mais aprofundada em: https://refactoring.guru/design-patterns/command\nDesign Pattern: Strategy Exemplo de: https://en.wikipedia.org/wiki/Strategy_pattern\n“Strategy permite que o algoritmo varie independentemente dos clientes que o utilizam. Strategy é um dos padrões incluídos no influente livro “Design Patterns” de Gamma et al., que popularizou o conceito de usar padrões de design para descrever como projetar software orientado a objetos flexível e reutilizável. Adiar a decisão sobre qual algoritmo usar até o tempo de execução permite que o código chamador seja mais flexível e reutilizável.” https://en.wikipedia.org/wiki/Strategy_pattern\npublic interface IComportamentoDeFreio { public void frear(); } public class FreioComABS implements IComportamentoDeFreio { public void frear() { System.out.println(\"Freio com ABS aplicado\"); } } public class FreioSimples implements IComportamentoDeFreio { public void frear() { System.out.println(\"Freio simples aplicado\"); } } /* Cliente que pode usar os algoritmos acima de forma intercambiável */ public abstract class Carro { private IComportamentoDeFreio comportamentoDeFreio; public Carro(IComportamentoDeFreio comportamentoDeFreio) { this.comportamentoDeFreio = comportamentoDeFreio; } public void aplicarFreio() { comportamentoDeFreio.frear(); // note que usamos a interface! } public void setComportamentoDeFreio(IComportamentoDeFreio tipoDeFreio) { this.comportamentoDeFreio = tipoDeFreio; // podemos mudar livremente! } } public class SUV extends Carro { public SUV() { super(new FreioComABS()); } } public class CarExample { public static void main(final String[] arguments) { Carro suvCar = new SUV(); suvCar.frear(); // freio com abs suvCar.setBrakeBehavior( new FreioSimples() ); suvCar.frear(); // freia, mas sem abs. } } Nesse exemplo, note que definimos uma interface comum, a qual um carro se acopla, podemos trocar a implementação dessa interface livremente, também ajuda no OCP.\nLiskov Substitution Principle Funções que utilizam ponteiros ou referências para classes base devem ser capazes de usar objetos de classes derivadas sem saber disso\nNesse caso, vamos começar com citações:\n“Se um gato possui raça e patas, e um cachorro possui raça, patas e tipoDoPelo, logo Cachorro extends Gato? Pode parecer engraçado, mas é (…) herança por preguiça, por comodismo, porque vai dar uma ajudinha. A relação “é um” não se encaixa aqui, e vai nos gerar problemas.” Paulo Silveira, no artigo Como não aprender orientação a objetos: Herança (SILVEIRA, 2006)\nO Princípio da Substituição de Liskov (LSP) estabelece uma diretriz fundamental : Ele afirma que objetos de classes derivadas ou subclasses devem poder ser usados no lugar de objetos da classe base ou superclasse sem quebrar o comportamento esperado do programa. Em outras palavras, uma classe derivada deve estender ou especializar o comportamento da classe base sem modificar seu contrato.\n“A ideia intuitiva de um subtipo é aquela cujos objetos fornecem todo o comportamento de objetos de outro tipo (o supertipo) mais algo extra.” Data Abstraction and Hierarchy (LISKOV, 1988)\nImagine um exemplo em que temos uma classe base chamada Animal e classes derivadas, como Cachorro e Gato. O LSP nos orienta a garantir que qualquer código que funcione com objetos Animal também funcione corretamente com objetos Cachorro e Gato. Isso significa que as subclasses não devem introduzir comportamentos que contradigam as expectativas estabelecidas pela classe base. Ou seja, se todo animal implementa o método comer, classes derivadas desse Animal devem também incluir o método comer, que funciona como esperado. (Se seu animal não come, reveja suas abstrações, o próximo princípio, ISP, pode ser útil aqui!)\nFavoreça composição sobre Herança Essa é uma frase amplamente falada no meio da computação, algo que você já ouviu milhares de vezes, seja em artigos, livros como o Design Patterns, do GoF ou até mesmo vídeos no youtube, mas por quê?\nEm vez de herdar comportamentos de uma classe base, prefira compor objetos que fornecem os comportamentos necessários. O princípio de design normalmente começa pela definição de interfaces que representam o comportamento que o sistema deve exibir, as classes recebem objetos dessas interfaces e fazem os comportamentos a partir daí\nBenefícios Favorecer a composição proporciona maior flexibilidade no design. É mais natural construir classes de domínio de negócios a partir de vários componentes do que tentar encontrar pontos em comum entre eles e criar uma árvore de herança. Por exemplo, um pedal de acelerador e um volante têm poucos traços em comum, mas são componentes vitais em um carro.\nAlém disso, a composição oferece um domínio de negócios mais estável, pois está menos sujeito às peculiaridades dos membros da família. Em outras palavras, é melhor compor o que um objeto pode fazer (tem-um) do que estender o que ele é (é-um).\nDrawbacks “Composition is good until it is not” - O uso excessivo de composição pode levar a classes superlotadas e complexas, mas de maneira geral, se você mantiver : A divisão de responsabilidades, O acoplamento controlado, Uso de Design Patterns adequados, isso provavelmente não será um problema.\nInterface Segregation Principle “*Make fine grained interfaces that are client specific.” ”Clients should not be forced to depend upon interfaces that they do not use”\nUncle Bob*\nO Interface Segregation Principle (ISP) basicamente nos orienta a escrever interfaces coesas, em que seus métodos conversem entre si e sempre sejam implementados.\nVamos a um exemplo:\ninterface Imposto { NotaFiscal geraNota(); double imposto(double valorCheio); } Imagine que em algum momento da existência da sua aplicação, um imposto não gere nota fiscal, nesse caso, ele irá jogar uma exception? retornar nulo? É exatamente esse tipo de situação que o ISP quer que você evite passar, pois ambas as opções anteriores são ruins e configuram quebra de contrato.\nNesse caso anterior, temos uma interface não muito coesa, com dois comportamentos distintos (isso se dá pois um imposto nem sempre gera nota), nesse caso, o mais adequado seria dividi-la em duas interfaces distintas, como por exemplo:\ninterface Tributavel{ double imposto(double valorCheio); } interface GeradorNF{ NotaFiscal geraNota(); } Com isso, podemos fazer com que nossas classes sejam construídas por composição de interfaces que às sirvam perfeitamente, como:\nclass ImpostoGeraNota implements Tributavel, GeradorNF{ // os dois métodos aqui } class Imposto implements Tributavel{ // implementa imposto(double valorCheio) } Many client specific interfaces are better than one general purpose interface\nUncle Bob\nAlém disso, muitas vezes queremos apenas parte dos atributos ou comportamentos de uma classe, e\nSe você tiver uma classe que tenha vários clientes, em vez de carregar a classe com todos os métodos de que os clientes precisam, crie interfaces específicas para cada cliente e implemente-as na classe.\nDesign Principles and Design Patterns (MARTIN, 2000)\nCitação retirada da Referência da Caelum\nPor que? Mas Kauê, por quê é uma boa prática criarmos interfaces magras? Como disse anteriormente, a palavra chave é coesão, a coesão é o elemento chave que garante a estabilidade de nossas interfaces, e se essa interface realmente precisar ser mudada, apenas os membros que implementam ela terão sua implementação alterada. No final das contas, o ISP é sobre avaliarmos a coesão das nossas interfaces,\nLembre-se também que devemos sempre nos acoplar a membros os mais estáveis possíveis! Nesse caso, tanto Tributavel quanto GeradorNF são mais interfaces coesas e estáveis.\n“Classes que dependem de interfaces leves sofrem menos com mudanças em outros pontos do sistema. Novamente, elas são pequenas, portanto, têm poucas razões para mudar.” - Aniche, M. OOP E SOLID para Ninjas.\nDependency Inversion Principle Depend upon Abstractions. Do not depend upon concretions. - Design Principles and Design Patterns, Bob Martin.\nAqui, vamos começar com conceitos bem fundamentados dentro da computação\n“Depender de abstrações e não de implementações” - Bob Martin ”Programe voltado à interface, não à implementação” - Design Patterns, GoF\nMas o que isso significa? A ideia aqui é que abstrações e interfaces definem contratos estáveis para nossos sistemas, classes e comportamentos base do sistema, ou seja, não-voláteis, não devem ser impactados por implementação de módulos as quais elas dependem.\nSua classe que cuida do registro do usuário não deve depender da implementação que o envio de email possui, você não deve ter imports de uma biblioteca específica dentro de uma classe que cuida de regras de negócio. Nesse caso, você deverá usar abstração, por exemplo, EnviadorEmail e usará algum método dela que encapsule detalhes de implementação\nVamos ver um exemplo bom:\npublic interface EnviadorEmail { void enviarEmail(String destinatario, String mensagem); } // em seu próprio arquivo: public class RegistrarUsuario { private final EnviadorEmail enviadorEmail; public RegistrarUsuario (EnviadorEmail enviadorEmail) { this.enviadorEmail = enviadorEmail; } public void registrarUsuario(String nome, String email) { // Lógica para registrar o usuário // Envio de e-mail de boas-vindas String mensagem = \"Bem-vindo, \" + nome + \"!\"; enviadorEmail.enviarEmail(email, mensagem); } } No código acima, podemos mudar a implementação do provedor de email e não precisaremos mexer na classe RegistrarUsuário, perfeito!\nUm pouco mais concreto: Vamos dar algumas definições que podem ajudar a você seguir como guideline para garantir que seu código está desacoplado\nMódulos de Alto Nível: São módulos que implementam regras de negócio, devem ser reutilizáveis, estáveis e inafetados por mudanças em módulos de baixo nível.\nMódulos de Baixo Nível: São módulos que dizem respeito à detalhes de implementação, muitas vezes, agem como utilitários para módulos de alto nível, mas devem ser utilizados através de uma barreira de abstração sempre que fizer sentido\nPortanto, nossa “”regra”” é:\nMódulos de Alto nível não devem depender explicitamente de módulos de baixo nível, e sim de abstrações.\nE de onde vem o nome de “Inversão de Dependência”? No exemplo acima é claro, RegistrarUsuário, uma classe de alto nível, depende do Enviador de Email, que utiliza a dependência do AWS SES, no final das contas, RegistrarUsuário também está acoplado ao SES.\nNesse caso, note que as dependências foram invertidas.\nNem toda interface é de alto nível A linguagem Java está cheia de interfaces e abstrações, mas muitas vezes essas abstrações atuam diretamente sobre detalhes de implementação, como java.sql.Connection do JDBC, elas são interfaces para mecanismos de entrega, detalhes técnicos e uma classe que depende delas, não necessariamente segue o dip, mas isso não é um problema, pois essas interfaces são estáveis\nDicas gerais Não precisamos implementar e criar uma dependência diretamente com a classe EnviadorEmailX ou EnviadorEmailY, nesse caso, podemos usar o design pattern Factory e abstrair essa dependência, podemos fazer isso dentro da própria interface com java. public interface EnviadorEmail { void enviarEmail(String destinatario, String mensagem); static EnviadorEmail criarEnviadorEmailPadrao() { return new EnviadorEmailPadrao(); } static EnviadorEmail criarEnviadorEmailAlternativo() { return new EnviadorEmailAlternativo(); } } // Em outra classe public class Main { public static void main(String[] args) { EnviadorEmail enviadorPadrao = EnviadorEmail.criarEnviadorEmailPadrao(); EnviadorEmail enviadorAlternativo = EnviadorEmail.criarEnviadorEmailAlternativo(); // Use as instâncias de EnviadorEmail conforme necessário enviadorPadrao.enviarEmail(\"destinatario@example.com\", \"Mensagem de teste\"); enviadorAlternativo.enviarEmail(\"outrodestinatario@example.com\", \"Outra mensagem de teste\"); } } Em java, se definirmos interfaces comuns para diversos provedores de notificação como enviadorMensagem, que ser para tanto enviadorEmail quanto enviadorSMS, podemos fazer com que o spring nos entregue uma lista com todos os Beans anotados com @Component que satisfaça essa interface (Podemos usar o applicationContext para isso), simplificando o código iterando pela lista e usando o seu método de enviar. @Component public class EnviadorEmail implements EnviadorMensagem { @Override public void enviarMensagem(String destinatario, String mensagem) { // abstraido :p } } @Component public class EnviadorSMS implements EnviadorMensagem { // você já sabe } Importante!! Obrigado pela leitura, espero que tenha sido útil, de verdade, tentei trazer exemplos de código e bastante citações, mas a maioria desse tipo de conteúdo é fonte dos livros da casa do código e caelum, mas de maneira mais enxuta e com minhas palavras, recomendo fortemente a compra dos dois livros abaixo.\nSe encontrar erros ortográficos ou algo estranho, me envie uma mensagem ou comente aqui, arrumarei assim que possível. Não farei uma rigorosa verificação antes de postar aqui.\nReferências https://www.amazon.com.br/Design-Patterns-Object-Oriented-Addison-Wesley-Professional-ebook/dp/B000SEIBB8\nhttps://en.wikipedia.org/wiki/Composition_over_inheritance\nhttps://www.casadocodigo.com.br/products/livro-oo-solid\nhttps://www.casadocodigo.com.br/products/livro-desbravando-solid\nhttps://github.com/caelum/apostila-oo-avancado-em-java/blob/master/09-interface-segregation-principle.md\nhttps://en.wikipedia.org/wiki/Strategy_pattern\nhttps://refactoring.guru/design-patterns/command\n","wordCount":"3431","inLanguage":"pt","image":"https://kaue.cat/%3Cimage%20path/url%3E","datePublished":"2023-11-12T16:30:03Z","dateModified":"2023-11-12T16:30:03Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kaue.cat/posts/solid/"},"publisher":{"@type":"Organization","name":"Kaue Gatto","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/kauegatto/hugo-PaperMod/6aab706f2e2053433e33f8fd45dbec615f4d479f/images/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kaue.cat accesskey=h title="Home (Alt + H)"><img src=https://kaue.cat/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://kaue.cat/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://kaue.cat/archives title=Arquivo><span>Arquivo</span></a></li><li><a href=https://kaue.cat/search/ title=Buscar><span>Buscar</span></a></li><li><a href=https://kaue.cat/series/ title=Séries><span>Séries</span></a></li><li><a href=https://kaue.cat/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://kaue.cat>Início</a>&nbsp;»&nbsp;<a href=https://kaue.cat/posts/>Posts</a></div><h1 class=post-title>SOLID! Um Post Aprofundado</h1><div class=post-description>Um post aprofundado sobre SOLID, com inúmeros exemplos de código e com um aprofundamento maior que o normal.</div><div class=post-meta><span title='2023-11-12 16:30:03 +0000 UTC'>12 de novembro , 2023</span>&nbsp;·&nbsp;17 minutos&nbsp;·&nbsp;3431 palavras&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/kauegatto/kauedotcat/content/posts/SOLID.md rel="noopener noreferrer" target=_blank>Sugerir Alterações</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Conteúdo</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#caso-real>Caso real</a></li></ul><ul><li><a href=#um-exemplo>Um exemplo</a><ul><li><a href=#melhorando>Melhorando</a></li></ul></li><li><a href=#abstrações-e-capacidade-de-extensão>Abstrações e Capacidade de Extensão</a></li><li><a href=#design-pattern-command>Design Pattern: Command</a></li><li><a href=#design-pattern-strategy>Design Pattern: Strategy</a></li></ul><ul><li><a href=#favoreça-composição-sobre-herança>Favoreça composição sobre Herança</a><ul><li><a href=#benefícios>Benefícios</a></li><li><a href=#drawbacks>Drawbacks</a></li></ul></li></ul><ul><li><a href=#por-que>Por que?</a></li></ul><ul><li><a href=#um-pouco-mais-concreto>Um pouco mais concreto:</a><ul><li><a href=#e-de-onde-vem-o-nome-de-inversão-de-dependência>E de onde vem o nome de “Inversão de Dependência”?</a></li></ul></li><li><a href=#nem-toda-interface-é-de-alto-nível>Nem toda interface é de alto nível</a></li><li><a href=#dicas-gerais>Dicas gerais</a></li></ul></nav></div></details></div><div class=post-content><p><a href="https://www.notion.so/kauegatto/2-SOLID-2803807def464f3e884a1311ead6955c?pvs=4">Leitura no Notion: SOLID</a></p><hr><p>Sei que existem 1 milhão de posts sobre SOLID, considero esse &ldquo;guia&rdquo; um pouco fora do comum pelo seu aprofundamento, tentei esclarecer todas as dúvidas que tinha ou poderia ter e sempre trazer exemplos, além de usar boas referências. Espero que esse post seja o seu guia definitivo de SOLID, assim como é para mim!</p><h1 id=o-que-é-solid>O que é SOLID?<a hidden class=anchor aria-hidden=true href=#o-que-é-solid>#</a></h1><p>SOLID é um Acrônimo para 5 boas práticas e/ou princípios que envolvem o desenvolvimento de um bom código orientado à objetos, não quero me estender na origem, vamos para os princípios!</p><h1 id=single-responsability-principle>Single Responsability Principle<a hidden class=anchor aria-hidden=true href=#single-responsability-principle>#</a></h1><p>O nome, embora auto-explicativo e que muitas vezes levava esse princípio a ser explicado como <em>“Uma classe deve ter uma, e apenas uma responsabilidade”</em> não é necessariamente o que você deve pensar na hora de implementá-lo. Entenda esse padrão como : <em><strong>“Uma classe deve ter um, e apenas um motivo para mudar”</strong></em>. Ou seja, não crie uma classe com a função de Emitir Nota Fiscal, crie uma classe NotaFiscal, e garanta que apenas coisas que envolvem o domínio de Nota Fiscal irão altera-lá, a mudança da emissão não muda o seu domínio de Nota Fiscal. Se uma alteração na impressora fizer a classe Nota Fiscal ser alterada, algo está incorreto.</p><blockquote><p>A questão principal do SRP é o motivo para uma classe ser modificada. E esse motivo para mudança, em geral, está relacionado a um grupo de usuários ou stakeholders, que Uncle
Bob chama de atores. - Desbravando Solid</p></blockquote><p>Levando em conta o que dizemos acima, também podemos dizer que o SRP pode ser definido por: <em>“Um módulo deve ser responsável por um , e apenas um ator”.</em> O ator que se importa com a função da emissão nota fiscal é o setor de vendas, o ator que se importa com suas horas extras, o rh, o ator que se importa com salvar no banco por id é a implementação de persistência.</p><p>Cada &ldquo;interessado&rdquo;, de negócio ou técnico, faz com que a classe tenha uma responsabilidade diferente.</p><p>Identificar classes que mudam por diversos motivos (ou atores) é simples, a coesão pode ser uma das métricas utilizadas:</p><blockquote><p>Classes coesas têm uma característica semelhante: os conceitos que essas classes representam estariam relacionados e separá-los seria pouco natural. O SRP, no fim das contas, é uma outra maneira de falar sobre a necessidade de código coeso. - Desbravando Solid</p></blockquote><p>Aniche (OOP E SOLID para ninjas) sugere que, para encontrar classes pouco coesas, devemos procurar classes que:</p><ul><li>Possuem muitos métodos diferentes.</li><li>São modificadas com frequência.</li><li>Não param nunca de crescer.</li></ul><p>Outro fator importante é perceber a duplicação (ou pior, repetição) de código. Se seu código possui partes repetidas diversas vezes, tenha isso como um forte indicativo que essa responsabilidade provavelmente deveria estar encapsulada em algum lugar (e muito provavelmente em uma classe).</p><p>Portanto, se seu sistema pega os dados, busca coisas no banco, salva como ePUB ou PDF, tudo em uma classe só, ele provavelmente não é coeso e muito menos segue o SRP. Um exemplo disso é que toda vez que a maneira que um pdf for gerado houver de mudar, você terá que mexer nessa classe principal, e se você tiver que repetir essa alteração em diversos pontos onde o código está repetido (o que já não é um bom indicador), você provavelmente terá problemas em algum momento (e mesmo que não tenha, sua manutenção definitivamente não está facilitada).</p><h2 id=caso-real>Caso real<a hidden class=anchor aria-hidden=true href=#caso-real>#</a></h2><p>Recentemente ajudei um amigo em um projeto pessoal, onde ele enviava emails para a confirmação de cadastro de usuários, todas essas responsabilidades ficavam dentro da mesma classe Usuário (Gerar token, enviar email, registrar usuário).
A partir daí, trabalhamos para termos um código mais coeso, no momento em que um usuário é registrado, ele envia um <strong>evento</strong> de registro de usuário (o que é só um aviso falando: cadastrei um usuário).
Com isso, uma classe chamada enviarEmailListener se prontificava a ouvir eventos de registro e alteração de senha de usuário e ela era a responsável por enviar emails.
Portanto, com o refactor, a classe de Usuário não se preocupa com o que acontece após o registro do usuário, ela apenas notifica que isso aconteceu.
Outro ponto de melhoria nisso foi a possibilidade de tornar o envio do email assíncrono, então para cadastrar um usuário, não precisavamos esperar o serviço de email fazer sua ação, ela é independente (nesse caso, não fazia sentido ser uma transação, o cadastro de um usuário não depende do email, se um erro ocorrer nessa etapa, ele pode só pedir outro email)</p><p>Note que se tivermos mais ocasiões onde devemos enviar emails de usuário (além de cadastro e alteração de emails) podemos apenas adicionar um novo evento a ser ouvido pelo listener e se precisarmos mudar a forma de enviar email, mudamos apenas em um único método (o que aumenta MUITO a capacidade de manter o código), essa é a função do SRP.</p><h1 id=open-closed-principle>Open-Closed Principle<a hidden class=anchor aria-hidden=true href=#open-closed-principle>#</a></h1><blockquote><p><em>Software entities &mldr; should be open for extension, but closed for modification.</em></p></blockquote><blockquote><p>A module will be said to be open if it is still available for extension. For example, it should be possible to add fields to the data structures it contains, or new elements to the set of functions it performs.</p></blockquote><p>Essas citações trazem uma noção base do que o OCP quer dizer, nosso código deve estar sempre pronto para evoluir. e de maneira natural, não devemos sentir a necessidade de modificar muitos arquivos diferentes, ou mesmo procurar (usando o CTRL+F, por exemplo) os lugares que devem ser alterados.</p><p>A segunda parte diz sobre ser fechada para modificação. nesse aspecto, podemos entender que elas não devem ter seu comportamento alterado a todo momento.</p><h2 id=um-exemplo>Um exemplo<a hidden class=anchor aria-hidden=true href=#um-exemplo>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CalculadoraDePrecos</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>double</span> <span class=nf>calcula</span><span class=o>(</span><span class=n>Compra</span> <span class=n>produto</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Frete</span> <span class=n>correios</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Frete</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>double</span> <span class=n>desconto</span> <span class=o>=</span> <span class=mf>0.0</span><span class=o>;</span> <span class=c1>// Inicialize desconto com um valor padrão
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>REGRA</span> <span class=mi>1</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=c1>// faz algo            
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>REGRA</span> <span class=mi>2</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>					<span class=c1>// faz algo            
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>produto</span><span class=o>.</span><span class=na>getValor</span><span class=o>()</span> <span class=o>*</span> <span class=o>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>desconto</span><span class=o>)</span> <span class=o>+</span> <span class=n>frete</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Note que sempre que adicionarmos regras de frete, nosso código precisará alterar a classe calculadora de preços, incluindo um novo IF, ou seja, a classe que implementar a regra de frete está acoplada à Calculadora de Preços</p><p>Uma segunda implementação comum é colocar os ifs dentro das classes
específicas. Por exemplo, a classe Frete passaria a ter as diferentes regras de negócio (os mesmos if-else). Apesar de ficar melhor, continua claro que não é a melhor abordagem.</p><h3 id=melhorando>Melhorando<a hidden class=anchor aria-hidden=true href=#melhorando>#</a></h3><p>Se temos diferentes regras de desconto e de frete, basta criarmos interfaces que as representam:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>TabelaDePreco</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>double</span> <span class=nf>descontoPara</span><span class=o>(</span><span class=kt>double</span> <span class=n>valor</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TabelaDePreco1</span> <span class=kd>implements</span> <span class=n>TabelaDePreco</span> <span class=o>{</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TabelaDePreco2</span> <span class=kd>implements</span> <span class=n>TabelaDePreco</span> <span class=o>{</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TabelaDePreco3</span> <span class=kd>implements</span> <span class=n>TabelaDePreco</span> <span class=o>{</span> <span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>ServicoDeEntrega</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>double</span> <span class=nf>para</span><span class=o>(</span><span class=n>String</span> <span class=n>cidade</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Frete1</span> <span class=kd>implements</span> <span class=n>ServicoDeEntrega</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Frete2</span> <span class=kd>implements</span> <span class=n>ServicoDeEntrega</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Frete3</span> <span class=kd>implements</span> <span class=n>ServicoDeEntrega</span> <span class=o>{}</span>
</span></span></code></pre></div><blockquote><p><strong>&ldquo;Veja que essa simples mudança altera toda a maneira de se lidar com a classe. Com ela &lsquo;aberta&rsquo;, ou seja, recebendo as dependências pelo construtor, podemos passar a implementação concreta que quisermos para ela. Se passarmos a implementação TabelaDePreco1, e invocarmos o método <code>calcula()</code>, o resultado será um; se passarmos a implementação TabelaDePreco2 e invocarmos o mesmo método, o resultado será outro.&rdquo; (ANICHE, 2015).</strong></p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CalculadoraDePrecos</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>TabelaDePreco</span> <span class=n>tabela</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ServicoDeEntrega</span> <span class=n>entrega</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>CalculadoraDePrecos</span><span class=o>(</span><span class=n>TabelaDePreco</span> <span class=n>tabela</span><span class=o>,</span> <span class=n>ServicoDeEntrega</span> <span class=n>entrega</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>tabela</span> <span class=o>=</span> <span class=n>tabela</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>entrega</span> <span class=o>=</span> <span class=n>entrega</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>double</span> <span class=nf>calcula</span><span class=o>(</span><span class=n>Compra</span> <span class=n>produto</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>double</span> <span class=n>desconto</span> <span class=o>=</span> <span class=n>tabela</span><span class=o>.</span><span class=na>descontoPara</span><span class=o>(</span><span class=n>produto</span><span class=o>.</span><span class=na>getValor</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=kt>double</span> <span class=n>frete</span> <span class=o>=</span> <span class=n>entrega</span><span class=o>.</span><span class=na>para</span><span class=o>(</span><span class=n>produto</span><span class=o>.</span><span class=na>getCidade</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>produto</span><span class=o>.</span><span class=na>getValor</span><span class=o>()</span> <span class=o>*</span> <span class=o>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>desconto</span><span class=o>)</span> <span class=o>+</span> <span class=n>frete</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Note que aqui trabalhamos também com a inversão de dependências (DIP), o “D”, do SOLID.</p><blockquote><p>&ldquo;Se o OCP declara o objetivo de uma arquitetura OO, o DIP declara o seu mecanismo fundamental.&rdquo;</p></blockquote><p>Se você ainda não leu sobre o DIP, continue lendo o post, mais tarde revisite esse ponto, vai fazer sentido 😃</p><h2 id=abstrações-e-capacidade-de-extensão>Abstrações e Capacidade de Extensão<a hidden class=anchor aria-hidden=true href=#abstrações-e-capacidade-de-extensão>#</a></h2><blockquote><p><strong>&ldquo;O que discutimos aqui, de certa forma, mistura-se com a discussão do capítulo anterior sobre estabilidade e inversão de dependências. As interfaces (abstrações) <code>TabelaDePreco</code> e <code>ServicoDeEntrega</code> tendem a ser estáveis. A <code>CalculadoraDePrecos</code> é uma implementação mais instável e que só depende de abstrações estáveis. Pensar em abstrações nos ajuda a resolver o problema do acoplamento e, de quebra, ainda nos ajuda a ter códigos facilmente extensíveis. Isso é programar orientado a objetos. É lidar com acoplamento, coesão, pensando em abstrações para nossos problemas. Quando se tem uma boa abstração, é fácil evoluir o sistema. Seu sistema deve evoluir por meio de novas implementações dessas abstrações, previamente pensadas, e não por meio de diversos ifs espalhados por todo o código.&rdquo; (ANICHE, 2015).</strong></p></blockquote><h2 id=design-pattern-command>Design Pattern: Command<a hidden class=anchor aria-hidden=true href=#design-pattern-command>#</a></h2><p>Não vou me aprofundar em patterns nesse post, mas acho legal repassar alguns exemplos que vi no material base</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EmissorNotaFiscal</span>	<span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span>	<span class=n>RegrasDeTributacao</span>	<span class=n>tributacao</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span>	<span class=n>LegislacaoFiscal</span>	<span class=n>legislacao</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span>	<span class=n>List</span><span class=o>&lt;</span><span class=n>AcaoPosEmissao</span><span class=o>&gt;</span>	<span class=n>acoes</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>//...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span>	<span class=n>NotaFiscal</span>	<span class=nf>gera</span><span class=o>(</span><span class=n>Fatura</span>	<span class=n>fatura</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>List</span><span class=o>&lt;</span><span class=n>Imposto</span><span class=o>&gt;</span>	<span class=n>impostos</span>	<span class=o>=</span>	<span class=n>tributacao</span><span class=o>.</span><span class=na>verifica</span><span class=o>(</span><span class=n>fatura</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>List</span><span class=o>&lt;</span><span class=n>Isencao</span><span class=o>&gt;</span>	<span class=n>isencoes</span>	<span class=o>=</span>	<span class=n>legislacao</span><span class=o>.</span><span class=na>analisa</span><span class=o>(</span><span class=n>fatura</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=c1>//	método	auxiliar
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>NotaFiscal</span>	<span class=n>nota</span>	<span class=o>=</span>	<span class=n>aplica</span><span class=o>(</span><span class=n>impostos</span><span class=o>,</span>	<span class=n>isencoes</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=c1>//	modificado
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>for</span>	<span class=o>(</span><span class=n>AcaoPosEmissao</span>	<span class=n>acao</span><span class=o>:</span>	<span class=n>acoes</span><span class=o>)</span>	<span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>acao</span><span class=o>.</span><span class=na>faz</span><span class=o>(</span><span class=n>nota</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>	<span class=n>nota</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span></code></pre></div><p>Exemplo do livro Desbravando Solid (AQUILES, 2022)</p><p>Note que é muito fácil adicionar novos comportamentos depois de uma nota fiscal ser emitida, podemos simplesmente adicionar um objeto na lista de ações, isso caracteriza o padrão <code>Command</code>.</p><p>Recomendo a leitura mais aprofundada em: <a href=https://refactoring.guru/design-patterns/command>https://refactoring.guru/design-patterns/command</a></p><h2 id=design-pattern-strategy>Design Pattern: Strategy<a hidden class=anchor aria-hidden=true href=#design-pattern-strategy>#</a></h2><p>Exemplo de: <a href=https://en.wikipedia.org/wiki/Strategy_pattern>https://en.wikipedia.org/wiki/Strategy_pattern</a></p><blockquote><p><strong>&ldquo;Strategy permite que o algoritmo varie independentemente dos clientes que o utilizam. Strategy é um dos padrões incluídos no influente livro &ldquo;Design Patterns&rdquo; de Gamma et al., que popularizou o conceito de usar padrões de design para descrever como projetar software orientado a objetos flexível e reutilizável. Adiar a decisão sobre qual algoritmo usar até o tempo de execução permite que o código chamador seja mais flexível e reutilizável.&rdquo;</strong>
<a href=https://en.wikipedia.org/wiki/Strategy_pattern>https://en.wikipedia.org/wiki/Strategy_pattern</a></p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>IComportamentoDeFreio</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>frear</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>FreioComABS</span> <span class=kd>implements</span> <span class=n>IComportamentoDeFreio</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>frear</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Freio com ABS aplicado&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>FreioSimples</span> <span class=kd>implements</span> <span class=n>IComportamentoDeFreio</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>frear</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Freio simples aplicado&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* Cliente que pode usar os algoritmos acima de forma intercambiável */</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>Carro</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>IComportamentoDeFreio</span> <span class=n>comportamentoDeFreio</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Carro</span><span class=o>(</span><span class=n>IComportamentoDeFreio</span> <span class=n>comportamentoDeFreio</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>comportamentoDeFreio</span> <span class=o>=</span> <span class=n>comportamentoDeFreio</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>aplicarFreio</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>comportamentoDeFreio</span><span class=o>.</span><span class=na>frear</span><span class=o>();</span> <span class=c1>// note que usamos a interface!
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setComportamentoDeFreio</span><span class=o>(</span><span class=n>IComportamentoDeFreio</span> <span class=n>tipoDeFreio</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>comportamentoDeFreio</span> <span class=o>=</span> <span class=n>tipoDeFreio</span><span class=o>;</span> <span class=c1>// podemos mudar livremente!
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SUV</span> <span class=kd>extends</span> <span class=n>Carro</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>SUV</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=k>new</span> <span class=n>FreioComABS</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CarExample</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>[]</span> <span class=n>arguments</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Carro</span> <span class=n>suvCar</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SUV</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>suvCar</span><span class=o>.</span><span class=na>frear</span><span class=o>();</span> <span class=c1>// freio com abs
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>suvCar</span><span class=o>.</span><span class=na>setBrakeBehavior</span><span class=o>(</span> <span class=k>new</span> <span class=n>FreioSimples</span><span class=o>()</span> <span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>suvCar</span><span class=o>.</span><span class=na>frear</span><span class=o>();</span>    <span class=c1>// freia, mas sem abs.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Nesse exemplo, note que definimos uma interface comum, a qual um carro se acopla, podemos trocar a implementação dessa interface livremente, também ajuda no OCP.</p><h1 id=liskov-substitution-principle>Liskov Substitution Principle<a hidden class=anchor aria-hidden=true href=#liskov-substitution-principle>#</a></h1><blockquote><p><em><strong>Funções que utilizam ponteiros ou referências para classes base devem ser capazes de usar objetos de classes derivadas sem saber disso</strong></em></p></blockquote><p>Nesse caso, vamos começar com citações:</p><blockquote><p><em><strong>&ldquo;Se um gato possui raça e patas, e um cachorro possui raça, patas e tipoDoPelo, logo Cachorro extends Gato? Pode parecer engraçado, mas é (&mldr;) herança por preguiça, por comodismo, porque vai dar uma ajudinha. A relação “é um” não se encaixa aqui, e vai nos gerar problemas.&rdquo;
Paulo Silveira, no artigo Como não aprender orientação a objetos: Herança (SILVEIRA, 2006)</strong></em></p></blockquote><p>O Princípio da Substituição de Liskov (LSP) estabelece uma diretriz fundamental : Ele afirma que objetos de classes derivadas ou subclasses devem poder ser usados no lugar de objetos da classe base ou superclasse sem quebrar o comportamento esperado do programa. Em outras palavras, uma classe derivada deve estender ou especializar o comportamento da classe base sem modificar seu contrato.</p><blockquote><p><em><strong>&ldquo;A ideia intuitiva de um subtipo é aquela cujos objetos fornecem todo o comportamento de objetos de outro tipo (o supertipo) mais algo extra.&rdquo;
Data Abstraction and Hierarchy (LISKOV, 1988)</strong></em></p></blockquote><p>Imagine um exemplo em que temos uma classe base chamada <strong><code>Animal</code></strong> e classes derivadas, como <strong><code>Cachorro</code></strong> e <strong><code>Gato</code></strong>. O LSP nos orienta a garantir que qualquer código que funcione com objetos <strong><code>Animal</code></strong> também funcione corretamente com objetos <strong><code>Cachorro</code></strong> e <strong><code>Gato</code></strong>. Isso significa que as subclasses não devem introduzir comportamentos que contradigam as expectativas estabelecidas pela classe base. Ou seja, se todo animal implementa o método comer, classes derivadas desse Animal devem também incluir o método comer, que funciona como esperado. (Se seu animal não come, reveja suas abstrações, o próximo princípio, ISP, pode ser útil aqui!)</p><h2 id=favoreça-composição-sobre-herança>Favoreça composição sobre Herança<a hidden class=anchor aria-hidden=true href=#favoreça-composição-sobre-herança>#</a></h2><p>Essa é uma frase amplamente falada no meio da computação, algo que você já ouviu milhares de vezes, seja em artigos, livros como o Design Patterns, do GoF ou até mesmo vídeos no youtube, mas por quê?</p><p>Em vez de herdar comportamentos de uma classe base, prefira compor objetos que fornecem os comportamentos necessários. O princípio de design normalmente começa pela definição de interfaces que representam o comportamento que o sistema deve exibir, as classes recebem objetos dessas interfaces e fazem os comportamentos a partir daí</p><h3 id=benefícios>Benefícios<a hidden class=anchor aria-hidden=true href=#benefícios>#</a></h3><p>Favorecer a composição proporciona maior flexibilidade no design. É mais natural construir classes de domínio de negócios a partir de vários componentes do que tentar encontrar pontos em comum entre eles e criar uma árvore de herança. Por exemplo, um pedal de acelerador e um volante têm poucos traços em comum, mas são componentes vitais em um carro.</p><p>Além disso, a composição oferece um domínio de negócios mais estável, pois está menos sujeito às peculiaridades dos membros da família. Em outras palavras, é melhor compor o que um objeto pode fazer (<em><strong><a href=https://en.wikipedia.org/wiki/Has-a>tem-um</a></strong></em>) do que estender o que ele é (<em><strong><a href=https://en.wikipedia.org/wiki/Is-a>é-um</a></strong></em>).</p><h3 id=drawbacks>Drawbacks<a hidden class=anchor aria-hidden=true href=#drawbacks>#</a></h3><p>“Composition is good until it is not” - O uso excessivo de composição pode levar a classes superlotadas e complexas, mas de maneira geral, se você mantiver : A divisão de responsabilidades, O acoplamento controlado, Uso de Design Patterns adequados, isso provavelmente não será um problema.</p><h1 id=interface-segregation-principle>Interface Segregation Principle<a hidden class=anchor aria-hidden=true href=#interface-segregation-principle>#</a></h1><blockquote><p><a href=http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod>“*Make fine grained interfaces that are client specific.”</a>
<a href=https://web.archive.org/web/20150906155800/http://www.objectmentor.com/resources/articles/Principles_and_Patterns.pdf>”Clients should not be forced to depend upon interfaces that they do not use”</a></p></blockquote><p>Uncle Bob*</p><blockquote></blockquote><p>O Interface Segregation Principle (ISP) basicamente nos orienta a escrever interfaces coesas, em que seus métodos conversem entre si e sempre sejam implementados.</p><p>Vamos a um exemplo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>Imposto</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=n>NotaFiscal</span> <span class=nf>geraNota</span><span class=o>();</span>
</span></span><span class=line><span class=cl>	<span class=kt>double</span> <span class=nf>imposto</span><span class=o>(</span><span class=kt>double</span> <span class=n>valorCheio</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Imagine que em algum momento da existência da sua aplicação, um imposto não gere nota fiscal, nesse caso, ele irá jogar uma exception? retornar nulo? É exatamente esse tipo de situação que o ISP quer que você evite passar, pois <strong>ambas as opções anteriores são ruins e configuram quebra de contrato.</strong></p><p>Nesse caso anterior, temos uma interface não muito coesa, com dois comportamentos distintos (isso se dá pois um imposto nem sempre gera nota), nesse caso, o mais adequado seria dividi-la em duas interfaces distintas, como por exemplo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>Tributavel</span><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>double</span> <span class=nf>imposto</span><span class=o>(</span><span class=kt>double</span> <span class=n>valorCheio</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>interface</span> <span class=nc>GeradorNF</span><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=n>NotaFiscal</span> <span class=nf>geraNota</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Com isso, podemos fazer com que nossas classes sejam construídas por composição de interfaces que às sirvam perfeitamente, como:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>ImpostoGeraNota</span> <span class=kd>implements</span> <span class=n>Tributavel</span><span class=o>,</span> <span class=n>GeradorNF</span><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// os dois métodos aqui
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Imposto</span> <span class=kd>implements</span> <span class=n>Tributavel</span><span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 	implementa imposto(double valorCheio)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><blockquote><p><a href=https://web.archive.org/web/20150906155800/http://www.objectmentor.com/resources/articles/Principles_and_Patterns.pdf>Many client specific interfaces are better than one general purpose interface</a></p></blockquote><p><em>Uncle Bob</em></p><blockquote></blockquote><p>Além disso, muitas vezes queremos apenas parte dos atributos ou comportamentos de uma classe, e</p><blockquote><p><em>Se você tiver uma classe que tenha vários clientes, em vez de carregar a classe com todos os métodos de que os clientes precisam, crie interfaces específicas para cada cliente e implemente-as na classe.</em></p><p><a href=http://www.cvc.uab.es/shared/teach/a21291/temes/object_oriented_design/materials_adicionals/principles_and_patterns.pdf>Design Principles and Design Patterns</a> (MARTIN, 2000)</p><p>Citação retirada da Referência da Caelum</p></blockquote><h2 id=por-que>Por que?<a hidden class=anchor aria-hidden=true href=#por-que>#</a></h2><p>Mas Kauê, por quê é uma boa prática criarmos interfaces magras? Como disse anteriormente, a palavra chave é <strong>coesão</strong>, a coesão é o elemento chave que garante a estabilidade de nossas interfaces, e se essa interface realmente precisar ser mudada, apenas os membros que implementam ela terão sua implementação alterada. No final das contas, o ISP é sobre avaliarmos a coesão das nossas interfaces,</p><p>Lembre-se também que devemos sempre nos acoplar a membros os mais estáveis possíveis! Nesse caso, tanto <code>Tributavel</code> quanto <code>GeradorNF</code> são mais interfaces coesas e estáveis.</p><blockquote><p>“Classes que dependem de interfaces leves sofrem menos com mudanças em outros pontos do sistema. Novamente, elas são pequenas, portanto, têm poucas razões para mudar.” - Aniche, M. OOP E SOLID para Ninjas.</p></blockquote><h1 id=dependency-inversion-principle>Dependency Inversion Principle<a hidden class=anchor aria-hidden=true href=#dependency-inversion-principle>#</a></h1><blockquote><p>Depend upon Abstractions. Do not depend upon concretions. - Design Principles and Design Patterns, Bob Martin.</p></blockquote><p>Aqui, vamos começar com conceitos bem fundamentados dentro da computação</p><blockquote><p>“Depender de abstrações e não de implementações” - Bob Martin
”Programe voltado à interface, não à implementação” - Design Patterns, GoF</p></blockquote><p>Mas o que isso significa? A ideia aqui é que abstrações e interfaces definem contratos estáveis para nossos sistemas, classes e comportamentos base do sistema, ou seja, não-voláteis, não devem ser impactados por implementação de módulos as quais elas dependem.</p><p>Sua classe que cuida do registro do usuário não deve depender da implementação que o envio de email possui, você não deve ter imports de uma biblioteca específica dentro de uma classe que cuida de regras de negócio. Nesse caso, você deverá usar abstração, por exemplo, <code>EnviadorEmail</code> e usará algum método dela que encapsule detalhes de implementação</p><p>Vamos ver um exemplo bom:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>EnviadorEmail</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>enviarEmail</span><span class=o>(</span><span class=n>String</span> <span class=n>destinatario</span><span class=o>,</span> <span class=n>String</span> <span class=n>mensagem</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// em seu próprio arquivo:
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RegistrarUsuario</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>final</span> <span class=n>EnviadorEmail</span> <span class=n>enviadorEmail</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>RegistrarUsuario</span> <span class=o>(</span><span class=n>EnviadorEmail</span> <span class=n>enviadorEmail</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>enviadorEmail</span> <span class=o>=</span> <span class=n>enviadorEmail</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>registrarUsuario</span><span class=o>(</span><span class=n>String</span> <span class=n>nome</span><span class=o>,</span> <span class=n>String</span> <span class=n>email</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Lógica para registrar o usuário
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// Envio de e-mail de boas-vindas
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>mensagem</span> <span class=o>=</span> <span class=s>&#34;Bem-vindo, &#34;</span> <span class=o>+</span> <span class=n>nome</span> <span class=o>+</span> <span class=s>&#34;!&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>enviadorEmail</span><span class=o>.</span><span class=na>enviarEmail</span><span class=o>(</span><span class=n>email</span><span class=o>,</span> <span class=n>mensagem</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>No código acima, podemos mudar a implementação do provedor de email e não precisaremos mexer na classe RegistrarUsuário, perfeito!</p><h2 id=um-pouco-mais-concreto>Um pouco mais concreto:<a hidden class=anchor aria-hidden=true href=#um-pouco-mais-concreto>#</a></h2><p>Vamos dar algumas definições que podem ajudar a você seguir como guideline para garantir que seu código está desacoplado</p><blockquote><p>Módulos de Alto Nível: São módulos que implementam regras de negócio, devem ser reutilizáveis, estáveis e inafetados por mudanças em módulos de baixo nível.</p></blockquote><p>Módulos de Baixo Nível: São módulos que dizem respeito à detalhes de implementação, muitas vezes, agem como utilitários para módulos de alto nível, mas devem ser utilizados através de uma barreira de abstração sempre que fizer sentido</p><blockquote></blockquote><p>Portanto, nossa “”regra”” é:</p><hr><p>Módulos de Alto nível não devem depender explicitamente de módulos de baixo nível, e sim de abstrações.</p><hr><h3 id=e-de-onde-vem-o-nome-de-inversão-de-dependência>E de onde vem o nome de “Inversão de Dependência”?<a hidden class=anchor aria-hidden=true href=#e-de-onde-vem-o-nome-de-inversão-de-dependência>#</a></h3><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ocx5a6bauxldjpj1amvq.png alt="Image description"></p><p>No exemplo acima é claro, <code>RegistrarUsuário</code>, uma classe de alto nível, depende do Enviador de Email, que utiliza a dependência do AWS SES, no final das contas, <code>RegistrarUsuário</code> também está acoplado ao SES.</p><p><img loading=lazy src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/j2oeb1i5vbr9crtjjvkd.png alt="Image description"></p><p>Nesse caso, note que as dependências foram invertidas.</p><h2 id=nem-toda-interface-é-de-alto-nível>Nem toda interface é de alto nível<a hidden class=anchor aria-hidden=true href=#nem-toda-interface-é-de-alto-nível>#</a></h2><p>A linguagem Java está cheia de interfaces e abstrações, mas muitas vezes essas abstrações atuam diretamente sobre detalhes de implementação, como <code>java.sql.Connection</code> do JDBC, elas são interfaces para mecanismos de entrega, detalhes técnicos e uma classe que depende delas, não necessariamente segue o dip, mas isso não é um problema, pois essas interfaces são <strong>estáveis</strong></p><h2 id=dicas-gerais>Dicas gerais<a hidden class=anchor aria-hidden=true href=#dicas-gerais>#</a></h2><ol><li>Não precisamos implementar e criar uma dependência diretamente com a classe EnviadorEmailX ou EnviadorEmailY, nesse caso, podemos usar o design pattern <code>Factory</code> e abstrair essa dependência, podemos fazer isso dentro da própria interface com java.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>EnviadorEmail</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>enviarEmail</span><span class=o>(</span><span class=n>String</span> <span class=n>destinatario</span><span class=o>,</span> <span class=n>String</span> <span class=n>mensagem</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>EnviadorEmail</span> <span class=nf>criarEnviadorEmailPadrao</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>EnviadorEmailPadrao</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>EnviadorEmail</span> <span class=nf>criarEnviadorEmailAlternativo</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>EnviadorEmailAlternativo</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Em outra classe
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Main</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>EnviadorEmail</span> <span class=n>enviadorPadrao</span> <span class=o>=</span> <span class=n>EnviadorEmail</span><span class=o>.</span><span class=na>criarEnviadorEmailPadrao</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>EnviadorEmail</span> <span class=n>enviadorAlternativo</span> <span class=o>=</span> <span class=n>EnviadorEmail</span><span class=o>.</span><span class=na>criarEnviadorEmailAlternativo</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Use as instâncias de EnviadorEmail conforme necessário
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>enviadorPadrao</span><span class=o>.</span><span class=na>enviarEmail</span><span class=o>(</span><span class=s>&#34;destinatario@example.com&#34;</span><span class=o>,</span> <span class=s>&#34;Mensagem de teste&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>enviadorAlternativo</span><span class=o>.</span><span class=na>enviarEmail</span><span class=o>(</span><span class=s>&#34;outrodestinatario@example.com&#34;</span><span class=o>,</span> <span class=s>&#34;Outra mensagem de teste&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ol><li>Em java, se definirmos interfaces comuns para diversos provedores de notificação como <code>enviadorMensagem</code>, que ser para tanto enviadorEmail quanto enviadorSMS, podemos fazer com que o spring nos entregue uma lista com todos os Beans anotados com <code>@Component</code> que satisfaça essa interface (Podemos usar o applicationContext para isso), simplificando o código iterando pela lista e usando o seu método de enviar.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnviadorEmail</span> <span class=kd>implements</span> <span class=n>EnviadorMensagem</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>enviarMensagem</span><span class=o>(</span><span class=n>String</span> <span class=n>destinatario</span><span class=o>,</span> <span class=n>String</span> <span class=n>mensagem</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>			<span class=c1>// abstraido :p
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EnviadorSMS</span> <span class=kd>implements</span> <span class=n>EnviadorMensagem</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// você já sabe
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><h1 id=importante>Importante!!<a hidden class=anchor aria-hidden=true href=#importante>#</a></h1><p>Obrigado pela leitura, espero que tenha sido útil, de verdade, tentei trazer exemplos de código e bastante citações, mas a maioria desse tipo de conteúdo é fonte dos livros da casa do código e caelum, mas de maneira mais enxuta e com minhas palavras, recomendo fortemente a compra dos dois livros abaixo.</p><p>Se encontrar erros ortográficos ou algo estranho, me envie uma mensagem ou comente aqui, arrumarei assim que possível. Não farei uma rigorosa verificação antes de postar aqui.</p><h1 id=referências>Referências<a hidden class=anchor aria-hidden=true href=#referências>#</a></h1><p><a href=https://www.amazon.com.br/Design-Patterns-Object-Oriented-Addison-Wesley-Professional-ebook/dp/B000SEIBB8>https://www.amazon.com.br/Design-Patterns-Object-Oriented-Addison-Wesley-Professional-ebook/dp/B000SEIBB8</a></p><p><a href="https://en.wikipedia.org/wiki/Composition_over_inheritance#:~:text=To%20favor%20composition%20over%20inheritance,and%20creating%20a%20family%20tree">https://en.wikipedia.org/wiki/Composition_over_inheritance</a></p><p><a href=https://www.casadocodigo.com.br/products/livro-oo-solid>https://www.casadocodigo.com.br/products/livro-oo-solid</a></p><p><a href=https://www.casadocodigo.com.br/products/livro-desbravando-solid>https://www.casadocodigo.com.br/products/livro-desbravando-solid</a></p><p><a href=https://github.com/caelum/apostila-oo-avancado-em-java/blob/master/09-interface-segregation-principle.md>https://github.com/caelum/apostila-oo-avancado-em-java/blob/master/09-interface-segregation-principle.md</a></p><p><a href=https://en.wikipedia.org/wiki/Strategy_pattern>https://en.wikipedia.org/wiki/Strategy_pattern</a></p><p><a href=https://refactoring.guru/design-patterns/command>https://refactoring.guru/design-patterns/command</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://kaue.cat/tags/solid/>SOLID</a></li><li><a href=https://kaue.cat/tags/poo/>POO</a></li><li><a href=https://kaue.cat/tags/architecture/>ARCHITECTURE</a></li></ul><nav class=paginav><a class=prev href=https://kaue.cat/posts/software-architecture-basics/><span class=title>« Página Anterior</span><br><span>Arquitetura de Software para devs: MVC, Hexagonal, DDD</span></a>
<a class=next href=https://kaue.cat/posts/java-rabbit/java_rabbitmq_parte2/><span class=title>Próxima Página »</span><br><span>RabbitMQ com Java e Spring : Entendendo de verdade e com um toque de elegância (parte 2)</span></a></nav><div class=share-buttons><a>Compartilhar:</a><br><a target=_blank rel="noopener noreferrer" aria-label="share SOLID! Um Post Aprofundado on x" href="https://x.com/intent/tweet/?text=SOLID%21%20Um%20Post%20Aprofundado&url=https%3a%2f%2fkaue.cat%2fposts%2fsolid%2f&hashtags=SOLID%2cPOO%2cARCHITECTURE"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share SOLID! Um Post Aprofundado on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fkaue.cat%2fposts%2fsolid%2f&title=SOLID%21%20Um%20Post%20Aprofundado&summary=SOLID%21%20Um%20Post%20Aprofundado&source=https%3a%2f%2fkaue.cat%2fposts%2fsolid%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share SOLID! Um Post Aprofundado on whatsapp" href="https://api.whatsapp.com/send?text=SOLID%21%20Um%20Post%20Aprofundado%20-%20https%3a%2f%2fkaue.cat%2fposts%2fsolid%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></div></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//www-kaue-cat.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://kaue.cat>Kaue Gatto</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copiar";function s(){t.innerHTML="copiado!",setTimeout(()=>{t.innerHTML="copiar"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>